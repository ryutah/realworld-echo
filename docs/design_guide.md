# Design Guide

各種設計に関する基本方針

## 命名規則

- ディレクトリ名
  - `-` 区切りにする
- ファイル名
  - 言語等にデファクトがなければ `_` 区切りにする
- テーブル名
  - 単数形で

## バックエンド実装

### エラー生成

`"github.com/cockroachdb/errors"` パッケージを利用して、トレース情報と詳細メッセージを追加する [MSUT]

## API

### リクエスト

#### 日付、時間

##### フォーマット

日付や時間は次の形式で扱う [MUST]

| タイプ       | フォーマット | 型     | 例                        |
| ------------ | ------------ | ------ | ------------------------- |
| 時間付き日付 | iso8601      | string | 2023-06-03T14:41:01+09:00 |
| 時間なし日付 | iso8601      | string | 2023-06-03                |
| 時間のみ     | HH:mm:ss     | string | 14:41:01                  |

#### 文字列

##### 最大文字数

クライアントが自由に入力できるフィールドには必ず最大文字数を設けること [MUST]

システム要件で特に指定のない場合は次の方針に従う [SHOULD]

| フィールドタイプ | 最大文字数 |
| ---------------- | ---------- |
| 短い文字列       | 256        |
| 長い文字列       | 1024       |
| とても長い文字列 | 1024       |
| email            | 256        |
| url              | 2048       |
| file path        | 256        |

---

### レスポンス

#### ステータスコード

[HTTP レスポンスステータスコード]を参考に、発生したエラーに応じて適切なものを付与する [MUST]

| ステータスコード範囲 | 用途                     |
| -------------------- | ------------------------ |
| 100 – 199            | 情報レスポンス           |
| 200 - 299            | 成功レスポンス           |
| 300 – 399            | リダイレクトメッセージ   |
| 400 – 499            | クライアントサイドエラー |
| 500 – 599            | サーバサイドエラー       |

#### エラー

クライアントサイドエラーが発生した場合は、発生した問題の詳細と解決方法をエラーメッセージに含める [SHOULD]

特に指定のない場合、エラーレスポンスは次のフォーマットにする [SHOULD]

```json
{
  "error": {
    "message": "[ERROR_SUMMARY_MESSAGE]"
    "errors": [
      {
        "message": "[ERROR_DETAILS]",
        "reason": "badRequest"
      }
    ],
  }
}
```

#### ページネーション

データ量が不確定な一覧を返す API は全データをまとめて返さずに、ページネーションを考慮した設計がされていること [MSUT]

## データベース

- テーブル名の命名規則は特にこだわりがなければ単数形とする
